import{R as x,Z as D,W as $,S as L,v as N,a2 as d,$ as n,Y as a,L as o,a6 as i,a4 as c,a3 as u,X as p,P as m,a1 as S,am as F,a7 as f,an as A,V as E,a8 as I}from"./index-DhmPxDvU.js";import{b as g}from"./route-block-B_A1xBdJ.js";import{a as R,b as _,V as z}from"./VRow-BMljVhGm.js";import{V as v}from"./VDivider-D1v1YBr1.js";import{V as P,a as T}from"./VList-Bu75zoQN.js";const j={class:"text-center"},U={class:"me-2"},W={__name:"cart",setup(X){const{apiAuth:l}=I(),h=x(),V=D(),k=$(),{t:y}=L(),s=N([]);(async()=>{try{const{data:e}=await l.get("/user/cart");s.value=e.result,console.log("購物車資料:",s.value)}catch(e){console.log(e)}})();const b=async e=>{try{const{data:r}=await l.delete("/user/cart",{data:{productId:e}});s.value=r.result,console.log("商品已從購物車移除")}catch(r){console.log(r)}},C=async()=>{var e,r;try{await l.post("/order"),h.cart=0,V.push("/orders")}catch(t){console.log(t),k({text:y("api."+(((r=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};function w(e){return new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})}return(e,r)=>(n(),d(z,{width:"80%"},{default:a(()=>[o(R,{justify:"center"},{default:a(()=>[o(_,{cols:"8"},{default:a(()=>[i("h1",j,c(e.$t("nav.cart")),1)]),_:1}),o(v),o(_,{cols:"12"},{default:a(()=>[u(c(s.value.value)+" ",1),o(P,{"bg-color":"#098d5b",rounded:"lg",lines:"two"},{default:a(()=>[(n(!0),p(m,null,S(s.value,(t,B)=>(n(),p(m,{key:t._id},[o(T,{title:t.product.name,subtitle:w(t.selectedDate)+"，"+t.selectedTime,"active-class":"bg-red",active:!t.product.sell},{prepend:a(()=>[o(A,{rounded:"lg",size:"80"},{default:a(()=>[o(E,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:a(()=>[i("div",U,c(t.product.price+"$"),1),o(f,{color:"deep-orange-accent-3",onClick:Z=>b(t.product._id)},{default:a(()=>[u(c(e.$t("cart.remove")),1)]),_:2},1032,["onClick"]),o(f,{color:"lime-accent-3",disabled:!t.product.sell,onClick:C},{default:a(()=>[u(c(e.$t("cart.checkout")),1)]),_:2},1032,["disabled"])]),_:2},1032,["title","subtitle","active"]),B<s.value.length-1?(n(),d(v,{key:0,color:"#FFEB3B",thickness:"2px"})):F("",!0)],64))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}};typeof g=="function"&&g(W);export{W as default};
